<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird - Vila do Chaves</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #87CEEB, #191970);
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        .game-container {
            position: relative;
            border: 5px solid #FFD700;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            background: linear-gradient(180deg, #87CEEB, #191970);
        }

        canvas {
            display: block;
            border-radius: 10px;
        }

        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #FFD700;
            font-size: 14px;
            z-index: 10;
        }

        .score {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #FFD700;
            font-size: 18px;
            font-weight: bold;
            z-index: 10;
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 30px;
            border-radius: 15px;
            border: 3px solid #FF4500;
            text-align: center;
            z-index: 20;
            display: none;
        }

        .upload-area {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #9370DB;
            font-size: 12px;
            z-index: 10;
        }

        .upload-area input[type="file"] {
            margin-top: 10px;
            color: white;
        }

        .instructions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #9370DB;
            font-size: 12px;
            z-index: 10;
        }

        .particles {
            position: absolute;
            pointer-events: none;
            z-index: 5;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #FFD700;
            border-radius: 50%;
            animation: orbit 3s linear infinite;
        }

        @keyframes orbit {
            from { transform: rotate(0deg) translateX(60px) rotate(0deg); }
            to { transform: rotate(360deg) translateX(60px) rotate(-360deg); }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <canvas id="gameCanvas" width="900" height="700"></canvas>
        
        <div class="controls">
            <h3>ðŸŽ® Controles</h3>
            <p>ðŸ”„ ESPAÃ‡O: Quico Pula</p>
            <p>ðŸ”„ R: Reiniciar</p>
            <p>ðŸ”„ ESC: Pausar</p>
        </div>

        <div class="score" id="score">
            Pontos: <span id="scoreValue">0</span>
        </div>

        <!-- Removido conforme solicitado: Ã¡rea de upload de imagem do amigo -->

        <div class="instructions">
            <h4>ðŸŽ¯ Como Jogar</h4>
            <p>â€¢ FaÃ§a o Quico passar nos tubos</p>
            <p>â€¢ Ganhe pontos!</p>
        </div>

        <div class="game-over" id="gameOver">
            <h2>ðŸŽ® GAME OVER!</h2>
            <p>PontuaÃ§Ã£o Final: <span id="finalScore">0</span></p>
            <p>Pressione R para reiniciar</p>
        </div>
    </div>

    <script>
        class FlappyBirdGame {
            constructor() {
                this.canvas = document.getElementById('gameCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.scoreElement = document.getElementById('scoreValue');
                this.gameOverElement = document.getElementById('gameOver');
                this.finalScoreElement = document.getElementById('finalScore');
                
                // ConfiguraÃ§Ãµes do jogo
                this.gravity = 0.3;
                this.jumpPower = -6;
                this.birdSize = 60;
                this.pipeWidth = 60;
                this.pipeGap = 200;
                this.pipeSpeed = 2;
                this.pipeSpacing = 300;
                
                // Estado do jogo
                this.gameRunning = false;
                this.gamePaused = false;
                this.score = 0;
                this.bird = {
                    x: 200,
                    y: this.canvas.height / 2,
                    velocity: 0,
                    image: null
                };
                
                this.pipes = [];
                this.clouds = [];
                this.particles = [];
                
                // Sons
                this.sounds = {
                    point: null,
                    collision: null
                };
                
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.loadPreloadedImage();
                this.createClouds();
                this.addPipe();
                this.loadPreloadedSounds();
                this.gameLoop();
            }
            
            setupEventListeners() {
                // Controles do teclado
                document.addEventListener('keydown', (e) => {
                    if (e.code === 'Space') {
                        e.preventDefault();
                        if (!this.gameRunning) {
                            this.startGame();
                        } else if (!this.gamePaused) {
                            this.jump();
                        }
                    } else if (e.code === 'KeyR') {
                        this.restartGame();
                    } else if (e.code === 'Escape') {
                        this.togglePause();
                    }
                });
                
                // Upload removido - usando apenas imagem prÃ©-configurada
            }
            
            loadPreloadedImage() {
                // Tentar carregar a imagem prÃ©-configurada
                const img = new Image();
                img.onload = () => {
                    this.loadBirdImage(img.src);
                    console.log('Imagem do amigo carregada com sucesso!');
                };
                img.onerror = () => {
                    console.log('Imagem prÃ©-configurada nÃ£o encontrada, usando pÃ¡ssaro padrÃ£o');
                    this.createBirdImage();
                };
                img.src = 'amigo.png';
            }
            
            createBirdImage() {
                // Criar pÃ¡ssaro padrÃ£o
                const canvas = document.createElement('canvas');
                canvas.width = this.birdSize;
                canvas.height = this.birdSize;
                const ctx = canvas.getContext('2d');
                
                // Borda dourada
                ctx.strokeStyle = '#FFD700';
                ctx.lineWidth = 4;
                ctx.beginPath();
                ctx.arc(this.birdSize/2, this.birdSize/2, this.birdSize/2 - 2, 0, Math.PI * 2);
                ctx.stroke();
                
                // Corpo do pÃ¡ssaro
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.ellipse(this.birdSize/2, this.birdSize/2 + 5, 15, 12, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // CabeÃ§a
                ctx.beginPath();
                ctx.arc(this.birdSize/2, this.birdSize/2 - 8, 12, 0, Math.PI * 2);
                ctx.fill();
                
                // Olhos
                ctx.fillStyle = 'white';
                ctx.beginPath();
                ctx.arc(this.birdSize/2 - 6, this.birdSize/2 - 12, 4, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(this.birdSize/2 + 6, this.birdSize/2 - 12, 4, 0, Math.PI * 2);
                ctx.fill();
                
                // Pupilas
                ctx.fillStyle = 'black';
                ctx.beginPath();
                ctx.arc(this.birdSize/2 - 6, this.birdSize/2 - 12, 2, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(this.birdSize/2 + 6, this.birdSize/2 - 12, 2, 0, Math.PI * 2);
                ctx.fill();
                
                // Bico
                ctx.fillStyle = '#FFA500';
                ctx.beginPath();
                ctx.moveTo(this.birdSize/2, this.birdSize/2 - 2);
                ctx.lineTo(this.birdSize/2 - 4, this.birdSize/2 + 4);
                ctx.lineTo(this.birdSize/2 + 4, this.birdSize/2 + 4);
                ctx.closePath();
                ctx.fill();
                
                this.bird.image = canvas;
            }
            
            loadBirdImage(imageSrc) {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = this.birdSize;
                    canvas.height = this.birdSize;
                    const ctx = canvas.getContext('2d');
                    
                    // Borda dourada
                    ctx.strokeStyle = '#FFD700';
                    ctx.lineWidth = 4;
                    ctx.beginPath();
                    ctx.arc(this.birdSize/2, this.birdSize/2, this.birdSize/2 - 2, 0, Math.PI * 2);
                    ctx.stroke();
                    
                    // Desenhar imagem redimensionada
                    ctx.drawImage(img, 2, 2, this.birdSize - 4, this.birdSize - 4);
                    
                    this.bird.image = canvas;
                };
                img.src = imageSrc;
            }
            
            createClouds() {
                for (let i = 0; i < 5; i++) {
                    this.clouds.push({
                        x: Math.random() * this.canvas.width,
                        y: Math.random() * 200,
                        size: 30 + Math.random() * 20,
                        speed: 0.2 + Math.random() * 0.3
                    });
                }
            }
            
            loadPreloadedSounds() {
                // Tentar carregar sons prÃ©-configurados
                this.sounds.point = new Audio('som_ponto.mp3');
                this.sounds.collision = new Audio('som_colisao.mp3');
                
                // Configurar sons
                this.sounds.point.volume = 0.7;
                this.sounds.collision.volume = 0.7;
                
                // Fallback para sons simples se os arquivos nÃ£o carregarem
                this.sounds.point.onerror = () => {
                    console.log('Som de ponto nÃ£o encontrado, usando som padrÃ£o');
                    this.sounds.point = this.createTone(440, 0.2);
                };
                
                this.sounds.collision.onerror = () => {
                    console.log('Som de colisÃ£o nÃ£o encontrado, usando som padrÃ£o');
                    this.sounds.collision = this.createTone(220, 0.5);
                };
                
                console.log('Sons da Vila do Chaves carregados!');
            }
            
            loadSounds() {
                // Criar sons simples usando Web Audio API
                this.sounds.point = this.createTone(440, 0.2);
                this.sounds.collision = this.createTone(220, 0.5);
            }
            
            createTone(frequency, duration) {
                return () => {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = frequency;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + duration);
                };
            }
            
            startGame() {
                this.gameRunning = true;
                this.gamePaused = false;
            }
            
            jump() {
                this.bird.velocity = this.jumpPower;
            }
            
            restartGame() {
                this.gameRunning = false;
                this.gamePaused = false;
                this.score = 0;
                this.bird.y = this.canvas.height / 2;
                this.bird.velocity = 0;
                this.pipes = [];
                this.particles = [];
                this.addPipe();
                this.gameOverElement.style.display = 'none';
                this.updateScore();
            }
            
            togglePause() {
                if (this.gameRunning) {
                    this.gamePaused = !this.gamePaused;
                }
            }
            
            addPipe() {
                const gapY = Math.random() * (this.canvas.height - this.pipeGap - 200) + 100;
                this.pipes.push({
                    x: this.canvas.width,
                    topHeight: gapY,
                    bottomY: gapY + this.pipeGap,
                    scored: false
                });
            }
            
            update() {
                if (!this.gameRunning || this.gamePaused) return;
                
                // Atualizar pÃ¡ssaro
                this.bird.velocity += this.gravity;
                this.bird.y += this.bird.velocity;
                
                // Atualizar tubos
                for (let i = this.pipes.length - 1; i >= 0; i--) {
                    const pipe = this.pipes[i];
                    pipe.x -= this.pipeSpeed;
                    
                    // Verificar pontuaÃ§Ã£o
                    if (!pipe.scored && pipe.x + this.pipeWidth < this.bird.x) {
                        pipe.scored = true;
                        this.score++;
                        this.updateScore();
                        this.playSound(this.sounds.point);
                        this.createParticles();
                    }
                    
                    // Remover tubos que saÃ­ram da tela
                    if (pipe.x + this.pipeWidth < 0) {
                        this.pipes.splice(i, 1);
                    }
                }
                
                // Adicionar novos tubos
                if (this.pipes.length === 0 || this.pipes[this.pipes.length - 1].x < this.canvas.width - this.pipeSpacing) {
                    this.addPipe();
                }
                
                // Atualizar nuvens
                this.clouds.forEach(cloud => {
                    cloud.x -= cloud.speed;
                    if (cloud.x < -cloud.size) {
                        cloud.x = this.canvas.width + cloud.size;
                    }
                });
                
                // Atualizar partÃ­culas
                this.particles.forEach((particle, index) => {
                    particle.x += particle.vx;
                    particle.y += particle.vy;
                    particle.life--;
                    
                    if (particle.life <= 0) {
                        this.particles.splice(index, 1);
                    }
                });
                
                // Verificar colisÃ£o
                if (this.checkCollision()) {
                    this.gameOver();
                }
            }
            
            checkCollision() {
                // ColisÃ£o com chÃ£o ou teto
                if (this.bird.y < 0 || this.bird.y + this.birdSize > this.canvas.height) {
                    return true;
                }
                
                // ColisÃ£o com tubos
                for (const pipe of this.pipes) {
                    if (this.bird.x < pipe.x + this.pipeWidth && 
                        this.bird.x + this.birdSize > pipe.x) {
                        if (this.bird.y < pipe.topHeight || 
                            this.bird.y + this.birdSize > pipe.bottomY) {
                            return true;
                        }
                    }
                }
                
                return false;
            }
            
            gameOver() {
                this.gameRunning = false;
                this.finalScoreElement.textContent = this.score;
                this.gameOverElement.style.display = 'block';
                this.playSound(this.sounds.collision);
            }
            
            createParticles() {
                for (let i = 0; i < 8; i++) {
                    this.particles.push({
                        x: this.bird.x + this.birdSize / 2,
                        y: this.bird.y + this.birdSize / 2,
                        vx: (Math.random() - 0.5) * 4,
                        vy: (Math.random() - 0.5) * 4,
                        life: 30,
                        color: '#FFD700'
                    });
                }
            }
            
            draw() {
                // Limpar tela
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Desenhar fundo gradiente
                this.drawGradientBackground();
                
                // Desenhar nuvens
                this.drawClouds();
                
                // Desenhar tubos
                this.drawPipes();
                
                // Desenhar pÃ¡ssaro
                this.drawBird();
                
                // Desenhar partÃ­culas
                this.drawParticles();
                
                // Desenhar efeitos orbitais
                this.drawOrbitalEffects();
            }
            
            drawGradientBackground() {
                const gradient = this.ctx.createLinearGradient(0, 0, 0, this.canvas.height);
                gradient.addColorStop(0, '#87CEEB');
                gradient.addColorStop(1, '#191970');
                this.ctx.fillStyle = gradient;
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
            }
            
            drawClouds() {
                this.ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                this.clouds.forEach(cloud => {
                    this.ctx.beginPath();
                    this.ctx.arc(cloud.x, cloud.y, cloud.size, 0, Math.PI * 2);
                    this.ctx.fill();
                    this.ctx.beginPath();
                    this.ctx.arc(cloud.x + cloud.size/2, cloud.y, cloud.size/2, 0, Math.PI * 2);
                    this.ctx.fill();
                    this.ctx.beginPath();
                    this.ctx.arc(cloud.x - cloud.size/2, cloud.y, cloud.size/2, 0, Math.PI * 2);
                    this.ctx.fill();
                });
            }
            
            drawPipes() {
                this.pipes.forEach(pipe => {
                    // Gradiente para os tubos
                    const gradient = this.ctx.createLinearGradient(pipe.x, 0, pipe.x, pipe.topHeight);
                    gradient.addColorStop(0, '#90EE90');
                    gradient.addColorStop(1, '#228B22');
                    
                    // Tubo superior
                    this.ctx.fillStyle = gradient;
                    this.ctx.fillRect(pipe.x, 0, this.pipeWidth, pipe.topHeight);
                    
                    // Tubo inferior
                    const bottomGradient = this.ctx.createLinearGradient(pipe.x, pipe.bottomY, pipe.x, this.canvas.height);
                    bottomGradient.addColorStop(0, '#90EE90');
                    bottomGradient.addColorStop(1, '#228B22');
                    this.ctx.fillStyle = bottomGradient;
                    this.ctx.fillRect(pipe.x, pipe.bottomY, this.pipeWidth, this.canvas.height - pipe.bottomY);
                    
                    // Bordas
                    this.ctx.strokeStyle = '#006400';
                    this.ctx.lineWidth = 3;
                    this.ctx.strokeRect(pipe.x, 0, this.pipeWidth, pipe.topHeight);
                    this.ctx.strokeRect(pipe.x, pipe.bottomY, this.pipeWidth, this.canvas.height - pipe.bottomY);
                });
            }
            
            drawBird() {
                if (this.bird.image) {
                    // Sombra
                    this.ctx.globalAlpha = 0.3;
                    this.ctx.drawImage(this.bird.image, this.bird.x + 3, this.bird.y + 3);
                    this.ctx.globalAlpha = 1;
                    
                    // PÃ¡ssaro principal
                    this.ctx.drawImage(this.bird.image, this.bird.x, this.bird.y);
                }
            }
            
            drawParticles() {
                this.particles.forEach(particle => {
                    this.ctx.globalAlpha = particle.life / 30;
                    this.ctx.fillStyle = particle.color;
                    this.ctx.beginPath();
                    this.ctx.arc(particle.x, particle.y, 3, 0, Math.PI * 2);
                    this.ctx.fill();
                });
                this.ctx.globalAlpha = 1;
            }
            
            drawOrbitalEffects() {
                if (!this.gameRunning) return;
                
                const time = Date.now() * 0.001;
                const centerX = this.bird.x + this.birdSize / 2;
                const centerY = this.bird.y + this.birdSize / 2;
                
                for (let i = 0; i < 6; i++) {
                    const angle = time * 1.5 + i * Math.PI / 3;
                    const radius = 55 + 8 * Math.sin(time * 2 + i);
                    const x = centerX + radius * Math.cos(angle);
                    const y = centerY + radius * Math.sin(angle);
                    
                    this.ctx.fillStyle = '#FFD700';
                    this.ctx.beginPath();
                    this.ctx.arc(x, y, 2, 0, Math.PI * 2);
                    this.ctx.fill();
                }
            }
            
            playSound(sound) {
                if (typeof sound === 'function') {
                    // Som gerado por Web Audio API
                    sound();
                } else if (sound && sound.play) {
                    // Arquivo de Ã¡udio
                    sound.currentTime = 0;
                    sound.play().catch(e => {
                        console.log('Erro ao reproduzir som:', e);
                    });
                }
            }
            
            updateScore() {
                this.scoreElement.textContent = this.score;
            }
            
            gameLoop() {
                this.update();
                this.draw();
                requestAnimationFrame(() => this.gameLoop());
            }
        }
        
        // Inicializar o jogo quando a pÃ¡gina carregar
        window.addEventListener('load', () => {
            new FlappyBirdGame();
        });
    </script>
</body>
</html>
